import{S as we,i as Ie,s as Be,C as rt,k as b,a as R,q as j,l as v,m as E,c as L,r as z,h as f,n as o,b as $,G as m,M as W,_ as at,D as ot,E as ut,F as it,u as ye,f as F,t as J,P as _e,w as le,e as ue,x as se,y as ne,X as ft,g as De,d as Te,z as re,R as ct,L as Ee,$ as dt,I as Se,J as Ne,O as $e,B as Le}from"../../../chunks/index-d8102d1a.js";import{l as nt,p as Ke,d as _t,q as mt,c as Qe,A as pt,n as bt,k as vt}from"../../../chunks/words-37495ea3.js";import{A as Ue}from"../../../chunks/Alert-83fe2429.js";import{N as kt}from"../../../chunks/Nav-12d3b04f.js";function ht(r){let e,l,s,a,c,t,u,n,i,k,w,g,_;const I=r[9].default,h=rt(I,r,r[8],null);return{c(){e=b("dialog"),l=b("div"),s=b("form"),h&&h.c(),a=R(),c=b("div"),t=b("button"),u=j(r[0]),n=R(),i=b("button"),k=j(r[1]),this.h()},l(N){e=v(N,"DIALOG",{class:!0,id:!0});var p=E(e);l=v(p,"DIV",{class:!0});var y=E(l);s=v(y,"FORM",{method:!0});var U=E(s);h&&h.l(U),a=L(U),c=v(U,"DIV",{class:!0});var C=E(c);t=v(C,"BUTTON",{type:!0,class:!0});var Q=E(t);u=z(Q,r[0]),Q.forEach(f),n=L(C),i=v(C,"BUTTON",{type:!0,class:!0});var H=E(i);k=z(H,r[1]),H.forEach(f),C.forEach(f),U.forEach(f),y.forEach(f),p.forEach(f),this.h()},h(){o(t,"type","submit"),o(t,"class","btn btn-primary"),o(i,"type","button"),o(i,"class","btn btn-secondary"),o(c,"class","dialog-controls svelte-153o6vl"),o(s,"method","dialog"),o(l,"class","modal-wrapper svelte-153o6vl"),o(e,"class","modal svelte-153o6vl"),o(e,"id",r[2])},m(N,p){$(N,e,p),m(e,l),m(l,s),h&&h.m(s,null),m(s,a),m(s,c),m(c,t),m(t,u),m(c,n),m(c,i),m(i,k),w=!0,g||(_=[W(i,"click",r[3]),W(s,"submit",r[5]),W(e,"click",at(r[3])),W(e,"close",r[4])],g=!0)},p(N,[p]){h&&h.p&&(!w||p&256)&&ot(h,I,N,N[8],w?it(I,N[8],p,null):ut(N[8]),null),(!w||p&1)&&ye(u,N[0]),(!w||p&2)&&ye(k,N[1]),(!w||p&4)&&o(e,"id",N[2])},i(N){w||(F(h,N),w=!0)},o(N){J(h,N),w=!1},d(N){N&&f(e),h&&h.d(N),g=!1,_e(_)}}}function Ye(r){r.querySelectorAll("form").forEach(e=>{e.reset()})}function gt(r,e,l){let{$$slots:s={},$$scope:a}=e,{onClose:c=()=>{}}=e,{onSubmit:t}=e,{submit_text:u="Submit"}=e,{cancel_text:n="Cancel"}=e,{id:i}=e;function k(_){const I=document.getElementById(i);I&&(c(I,_),Ye(I),I.close())}function w(_){const I=document.getElementById(i);I&&(c(I,_),Ye(I))}function g(_){const I=document.getElementById(i);if(!I){_.preventDefault();return}t(I,_)?I.close():_.preventDefault()}return r.$$set=_=>{"onClose"in _&&l(6,c=_.onClose),"onSubmit"in _&&l(7,t=_.onSubmit),"submit_text"in _&&l(0,u=_.submit_text),"cancel_text"in _&&l(1,n=_.cancel_text),"id"in _&&l(2,i=_.id),"$$scope"in _&&l(8,a=_.$$scope)},[u,n,i,k,w,g,c,t,a,s]}class Ze extends we{constructor(e){super(),Ie(this,e,gt,ht,Be,{onClose:6,onSubmit:7,submit_text:0,cancel_text:1,id:2})}}function xe(r,e,l){const s=r.slice();return s[30]=e[l],s}function yt(r){let e,l;return{c(){e=b("button"),l=b("i"),this.h()},l(s){e=v(s,"BUTTON",{type:!0,class:!0});var a=E(e);l=v(a,"I",{class:!0}),E(l).forEach(f),a.forEach(f),this.h()},h(){o(l,"class","fa-solid fa-xmark"),o(e,"type","button"),o(e,"class","remove-btn svelte-5rpock"),e.disabled=!0},m(s,a){$(s,e,a),m(e,l)},p:Le,d(s){s&&f(e)}}}function Et(r){let e,l,s,a;function c(...t){return r[16](r[30],...t)}return{c(){e=b("button"),l=b("i"),this.h()},l(t){e=v(t,"BUTTON",{type:!0,class:!0});var u=E(e);l=v(u,"I",{class:!0}),E(l).forEach(f),u.forEach(f),this.h()},h(){o(l,"class","fa-solid fa-xmark"),o(e,"type","button"),o(e,"class","remove-btn svelte-5rpock")},m(t,u){$(t,e,u),m(e,l),s||(a=W(e,"click",c),s=!0)},p(t,u){r=t},d(t){t&&f(e),s=!1,a()}}}function wt(r){let e,l;return{c(){e=b("button"),l=b("i"),this.h()},l(s){e=v(s,"BUTTON",{type:!0,class:!0});var a=E(e);l=v(a,"I",{class:!0}),E(l).forEach(f),a.forEach(f),this.h()},h(){o(l,"class","fa-solid fa-pen"),o(e,"type","button"),e.disabled=!0,o(e,"class","btn rename-btn svelte-5rpock")},m(s,a){$(s,e,a),m(e,l)},p:Le,d(s){s&&f(e)}}}function It(r){let e,l,s,a,c,t,u,n,i,k;function w(...g){return r[18](r[30],...g)}return{c(){e=b("button"),l=b("i"),c=R(),t=b("input"),this.h()},l(g){e=v(g,"BUTTON",{type:!0,id:!0,title:!0,class:!0});var _=E(e);l=v(_,"I",{class:!0}),E(l).forEach(f),_.forEach(f),c=L(g),t=v(g,"INPUT",{type:!0,name:!0,class:!0,title:!0,id:!0}),this.h()},h(){o(l,"class","fa-solid fa-pen"),o(e,"type","submit"),o(e,"id",s=r[0]+"-backup-rename-"+r[30].name),o(e,"title","Rename backup"),e.value=a=r[30].name,o(e,"class","btn rename-btn svelte-5rpock"),o(t,"type","radio"),o(t,"name","btn-edit"),o(t,"class","btn-edit svelte-5rpock"),o(t,"title","Select backup for restore"),o(t,"id",u=r[0]+"-restore-"+r[30].key),t.required=!0,t.value=n=r[30].name},m(g,_){$(g,e,_),m(e,l),$(g,c,_),$(g,t,_),i||(k=W(e,"click",w),i=!0)},p(g,_){r=g,_[0]&3&&s!==(s=r[0]+"-backup-rename-"+r[30].name)&&o(e,"id",s),_[0]&2&&a!==(a=r[30].name)&&(e.value=a),_[0]&3&&u!==(u=r[0]+"-restore-"+r[30].key)&&o(t,"id",u),_[0]&2&&n!==(n=r[30].name)&&(t.value=n)},d(g){g&&f(e),g&&f(c),g&&f(t),i=!1,k()}}}function et(r,e){let l,s,a,c,t,u,n,i,k,w=e[30].name+"",g,_,I,h,N,p=e[30].size+"",y,U,C,Q;function H(P,q){return P[30].name!=P[0]?Et:yt}let X=H(e),V=X(e);function ie(...P){return e[17](e[30],...P)}function te(P,q){return P[30].name!=P[0]?It:wt}let ee=te(e),M=ee(e);return{key:r,first:null,c(){l=b("div"),s=b("div"),V.c(),a=R(),c=b("button"),t=b("i"),u=R(),M.c(),n=R(),i=b("div"),k=b("label"),g=j(w),I=R(),h=b("div"),N=j("("),y=j(p),U=j(" words)"),this.h()},l(P){l=v(P,"DIV",{class:!0});var q=E(l);s=v(q,"DIV",{class:!0});var G=E(s);V.l(G),a=L(G),c=v(G,"BUTTON",{type:!0,class:!0});var B=E(c);t=v(B,"I",{class:!0}),E(t).forEach(f),B.forEach(f),u=L(G),M.l(G),n=L(G),i=v(G,"DIV",{class:!0});var D=E(i);k=v(D,"LABEL",{class:!0,for:!0,title:!0});var S=E(k);g=z(S,w),S.forEach(f),I=L(D),h=v(D,"DIV",{class:!0});var O=E(h);N=z(O,"("),y=z(O,p),U=z(O," words)"),O.forEach(f),D.forEach(f),G.forEach(f),q.forEach(f),this.h()},h(){o(t,"class","fa-solid fa-download"),o(c,"type","button"),o(c,"class","btn download-btn svelte-5rpock"),o(k,"class","backup-name-label svelte-5rpock"),o(k,"for",_=e[0]+"-restore-"+e[30].key),o(k,"title","Select backup for restore"),o(h,"class","backup-length svelte-5rpock"),o(i,"class","backup-name svelte-5rpock"),o(s,"class","backup-content svelte-5rpock"),o(l,"class","backup-entry svelte-5rpock"),this.first=l},m(P,q){$(P,l,q),m(l,s),V.m(s,null),m(s,a),m(s,c),m(c,t),m(s,u),M.m(s,null),m(s,n),m(s,i),m(i,k),m(k,g),m(i,I),m(i,h),m(h,N),m(h,y),m(h,U),C||(Q=W(c,"click",ie),C=!0)},p(P,q){e=P,X===(X=H(e))&&V?V.p(e,q):(V.d(1),V=X(e),V&&(V.c(),V.m(s,a))),ee===(ee=te(e))&&M?M.p(e,q):(M.d(1),M=ee(e),M&&(M.c(),M.m(s,n))),q[0]&2&&w!==(w=e[30].name+"")&&ye(g,w),q[0]&3&&_!==(_=e[0]+"-restore-"+e[30].key)&&o(k,"for",_),q[0]&2&&p!==(p=e[30].size+"")&&ye(y,p)},d(P){P&&f(l),V.d(),M.d(),C=!1,Q()}}}function tt(r){let e,l,s,a,c;return{c(){e=j(`Backup as:
                `),l=b("input"),this.h()},l(t){e=z(t,`Backup as:
                `),l=v(t,"INPUT",{id:!0,name:!0,type:!0,class:!0,placeholder:!0}),this.h()},h(){o(l,"id",s=r[0]+"-original-name"),o(l,"name","save-as"),o(l,"type","text"),o(l,"class","original form-control svelte-5rpock"),o(l,"placeholder","new name"),l.required=!0},m(t,u){$(t,e,u),$(t,l,u),Ee(l,r[2]),a||(c=[W(l,"input",r[21]),W(l,"blur",r[22])],a=!0)},p(t,u){u[0]&1&&s!==(s=t[0]+"-original-name")&&o(l,"id",s),u[0]&4&&l.value!==t[2]&&Ee(l,t[2])},d(t){t&&f(e),t&&f(l),a=!1,_e(c)}}}function Bt(r){let e,l,s,a,c,t,u,n,i,k,w,g,_=r[3]&&tt(r);return{c(){e=b("div"),l=b("div"),s=b("input"),c=R(),t=b("label"),u=j("Backup current list"),i=R(),k=b("div"),_&&_.c(),this.h()},l(I){e=v(I,"DIV",{class:!0});var h=E(e);l=v(h,"DIV",{class:!0});var N=E(l);s=v(N,"INPUT",{type:!0,id:!0}),c=L(N),t=v(N,"LABEL",{for:!0});var p=E(t);u=z(p,"Backup current list"),p.forEach(f),N.forEach(f),i=L(h),k=v(h,"DIV",{});var y=E(k);_&&_.l(y),y.forEach(f),h.forEach(f),this.h()},h(){o(s,"type","checkbox"),o(s,"id",a=r[0]+"-rename-current"),o(t,"for",n=r[0]+"-rename-current"),o(l,"class","dialog-title svelte-5rpock"),o(e,"class","original-name svelte-5rpock")},m(I,h){$(I,e,h),m(e,l),m(l,s),s.checked=r[3],m(l,c),m(l,t),m(t,u),m(e,i),m(e,k),_&&_.m(k,null),w||(g=W(s,"change",r[20]),w=!0)},p(I,h){h[0]&1&&a!==(a=I[0]+"-rename-current")&&o(s,"id",a),h[0]&8&&(s.checked=I[3]),h[0]&1&&n!==(n=I[0]+"-rename-current")&&o(t,"for",n),I[3]?_?_.p(I,h):(_=tt(I),_.c(),_.m(k,null)):_&&(_.d(1),_=null)},d(I){I&&f(e),_&&_.d(),w=!1,g()}}}function Dt(r){let e,l,s,a,c,t,u;return{c(){e=b("input"),s=R(),a=b("input"),this.h()},l(n){e=v(n,"INPUT",{type:!0,id:!0,class:!0}),s=L(n),a=v(n,"INPUT",{type:!0,id:!0}),this.h()},h(){o(e,"type","text"),o(e,"id",l=r[0]+"-rename-backup"),o(e,"class","form-control"),o(a,"type","hidden"),o(a,"id",c=r[0]+"-rename-hidden")},m(n,i){$(n,e,i),Ee(e,r[6]),$(n,s,i),$(n,a,i),t||(u=[W(e,"blur",r[23]),W(e,"input",r[24])],t=!0)},p(n,i){i[0]&1&&l!==(l=n[0]+"-rename-backup")&&o(e,"id",l),i[0]&64&&e.value!==n[6]&&Ee(e,n[6]),i[0]&1&&c!==(c=n[0]+"-rename-hidden")&&o(a,"id",c)},d(n){n&&f(e),n&&f(s),n&&f(a),t=!1,_e(u)}}}function lt(r){let e,l,s,a;const c=[St,Tt],t=[];function u(n,i){return n[5]!=null?0:1}return e=u(r),l=t[e]=c[e](r),{c(){l.c(),s=ue()},l(n){l.l(n),s=ue()},m(n,i){t[e].m(n,i),$(n,s,i),a=!0},p(n,i){let k=e;e=u(n),e===k?t[e].p(n,i):(De(),J(t[k],1,1,()=>{t[k]=null}),Te(),l=t[e],l?l.p(n,i):(l=t[e]=c[e](n),l.c()),F(l,1),l.m(s.parentNode,s))},i(n){a||(F(l),a=!0)},o(n){J(l),a=!1},d(n){t[e].d(n),n&&f(s)}}}function Tt(r){let e,l,s;function a(t){r[26](t)}let c={};return r[4]!==void 0&&(c.message=r[4]),e=new Ue({props:c}),Se.push(()=>Ne(e,"message",a,r[4])),{c(){le(e.$$.fragment)},l(t){se(e.$$.fragment,t)},m(t,u){ne(e,t,u),s=!0},p(t,u){const n={};!l&&u[0]&16&&(l=!0,n.message=t[4],$e(()=>l=!1)),e.$set(n)},i(t){s||(F(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){re(e,t)}}}function St(r){let e,l,s;function a(t){r[25](t)}let c={alert_style:r[5]};return r[4]!==void 0&&(c.message=r[4]),e=new Ue({props:c}),Se.push(()=>Ne(e,"message",a,r[4])),{c(){le(e.$$.fragment)},l(t){se(e.$$.fragment,t)},m(t,u){ne(e,t,u),s=!0},p(t,u){const n={};u[0]&32&&(n.alert_style=t[5]),!l&&u[0]&16&&(l=!0,n.message=t[4],$e(()=>l=!1)),e.$set(n)},i(t){s||(F(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){re(e,t)}}}function Nt(r){let e,l,s,a,c,t,u,n,i,k,w,g,_,I,h,N,p,y,U,C=[],Q=new Map,H,X,V,ie,te,ee,M,P,q,G,B,D,S,O,K,Y,Z,Ce,me,ae,pe,oe,be,ce,fe,Ve,Me,ve=r[1];const Pe=d=>d[30].key;for(let d=0;d<ve.length;d+=1){let T=xe(r,ve,d),x=Pe(T);Q.set(x,C[d]=et(x,T))}ae=new Ze({props:{id:"backup-modal",onSubmit:r[9],submit_text:"Restore",$$slots:{default:[Bt]},$$scope:{ctx:r}}}),oe=new Ze({props:{id:"rename-modal",onSubmit:r[8],onClose:r[13],submit_text:"Rename",$$slots:{default:[Dt]},$$scope:{ctx:r}}});let A=r[4]&&lt(r);return{c(){e=b("legend"),l=j("Save Backup"),s=R(),a=b("div"),c=b("form"),t=b("div"),u=b("div"),n=j(`Backup name:
                `),i=b("input"),w=R(),g=b("button"),_=j("Create Backup"),I=R(),h=b("legend"),N=j("Saved Backups"),p=R(),y=b("div"),U=b("form");for(let d=0;d<C.length;d+=1)C[d].c();H=R(),X=b("div"),V=b("button"),ie=j("Restore"),ee=R(),M=b("legend"),P=j("Upload Backup"),q=R(),G=b("div"),B=b("form"),D=b("div"),S=b("div"),O=b("input"),Y=R(),Z=b("button"),Ce=j("Restore Backup"),me=R(),le(ae.$$.fragment),pe=R(),le(oe.$$.fragment),be=R(),A&&A.c(),ce=ue(),this.h()},l(d){e=v(d,"LEGEND",{class:!0});var T=E(e);l=z(T,"Save Backup"),T.forEach(f),s=L(d),a=v(d,"DIV",{class:!0});var x=E(a);c=v(x,"FORM",{});var de=E(c);t=v(de,"DIV",{class:!0});var ke=E(t);u=v(ke,"DIV",{});var Oe=E(u);n=z(Oe,`Backup name:
                `),i=v(Oe,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),Oe.forEach(f),w=L(ke),g=v(ke,"BUTTON",{class:!0});var Ae=E(g);_=z(Ae,"Create Backup"),Ae.forEach(f),ke.forEach(f),de.forEach(f),x.forEach(f),I=L(d),h=v(d,"LEGEND",{class:!0});var Fe=E(h);N=z(Fe,"Saved Backups"),Fe.forEach(f),p=L(d),y=v(d,"DIV",{class:!0});var qe=E(y);U=v(qe,"FORM",{id:!0});var he=E(U);for(let Re=0;Re<C.length;Re+=1)C[Re].l(he);H=L(he),X=v(he,"DIV",{class:!0});var Ge=E(X);V=v(Ge,"BUTTON",{type:!0,class:!0,name:!0});var je=E(V);ie=z(je,"Restore"),je.forEach(f),Ge.forEach(f),he.forEach(f),qe.forEach(f),ee=L(d),M=v(d,"LEGEND",{class:!0});var ze=E(M);P=z(ze,"Upload Backup"),ze.forEach(f),q=L(d),G=v(d,"DIV",{class:!0});var We=E(G);B=v(We,"FORM",{});var Je=E(B);D=v(Je,"DIV",{class:!0});var ge=E(D);S=v(ge,"DIV",{class:!0});var Xe=E(S);O=v(Xe,"INPUT",{id:!0,class:!0,type:!0,accept:!0}),Xe.forEach(f),Y=L(ge),Z=v(ge,"BUTTON",{class:!0});var He=E(Z);Ce=z(He,"Restore Backup"),He.forEach(f),ge.forEach(f),Je.forEach(f),We.forEach(f),me=L(d),se(ae.$$.fragment,d),pe=L(d),se(oe.$$.fragment,d),be=L(d),A&&A.l(d),ce=ue(),this.h()},h(){o(e,"class","options-group-title"),o(i,"id",k=r[0]+"-new-backup-name"),o(i,"type","text"),o(i,"class","new-backup-name form-control svelte-5rpock"),o(i,"placeholder","new name"),o(g,"class","btn btn-primary"),o(t,"class","new-backup svelte-5rpock"),o(a,"class","options-group"),o(h,"class","options-group-title"),o(V,"type","button"),o(V,"class","btn btn btn-danger"),o(V,"name","backups_action"),V.value="restore",o(X,"class","backup-submit svelte-5rpock"),o(U,"id",te=r[0]+"-backup-list-form"),o(y,"class","options-group"),o(M,"class","options-group-title"),o(O,"id",K=r[0]+"-upload-backup"),o(O,"class","upload-backup form-control svelte-5rpock"),o(O,"type","file"),o(O,"accept",".json,application/json"),o(S,"class","upload-backup-container"),o(Z,"class","btn btn-danger upload-backup-btn svelte-5rpock"),o(D,"class","new-backup svelte-5rpock"),o(G,"class","options-group")},m(d,T){$(d,e,T),m(e,l),$(d,s,T),$(d,a,T),m(a,c),m(c,t),m(t,u),m(u,n),m(u,i),m(t,w),m(t,g),m(g,_),$(d,I,T),$(d,h,T),m(h,N),$(d,p,T),$(d,y,T),m(y,U);for(let x=0;x<C.length;x+=1)C[x].m(U,null);m(U,H),m(U,X),m(X,V),m(V,ie),$(d,ee,T),$(d,M,T),m(M,P),$(d,q,T),$(d,G,T),m(G,B),m(B,D),m(D,S),m(S,O),m(D,Y),m(D,Z),m(Z,Ce),$(d,me,T),ne(ae,d,T),$(d,pe,T),ne(oe,d,T),$(d,be,T),A&&A.m(d,T),$(d,ce,T),fe=!0,Ve||(Me=[W(i,"blur",r[15]),W(c,"submit",r[10]),W(V,"click",$t),W(B,"submit",r[19])],Ve=!0)},p(d,T){(!fe||T[0]&1&&k!==(k=d[0]+"-new-backup-name"))&&o(i,"id",k),T[0]&20483&&(ve=d[1],C=ft(C,T,Pe,1,d,ve,Q,U,dt,et,H,xe)),(!fe||T[0]&1&&te!==(te=d[0]+"-backup-list-form"))&&o(U,"id",te),(!fe||T[0]&1&&K!==(K=d[0]+"-upload-backup"))&&o(O,"id",K);const x={};T[0]&13|T[1]&4&&(x.$$scope={dirty:T,ctx:d}),ae.$set(x);const de={};T[0]&65|T[1]&4&&(de.$$scope={dirty:T,ctx:d}),oe.$set(de),d[4]?A?(A.p(d,T),T[0]&16&&F(A,1)):(A=lt(d),A.c(),F(A,1),A.m(ce.parentNode,ce)):A&&(De(),J(A,1,1,()=>{A=null}),Te())},i(d){fe||(F(ae.$$.fragment,d),F(oe.$$.fragment,d),F(A),fe=!0)},o(d){J(ae.$$.fragment,d),J(oe.$$.fragment,d),J(A),fe=!1},d(d){d&&f(e),d&&f(s),d&&f(a),d&&f(I),d&&f(h),d&&f(p),d&&f(y);for(let T=0;T<C.length;T+=1)C[T].d();d&&f(ee),d&&f(M),d&&f(q),d&&f(G),d&&f(me),re(ae,d),d&&f(pe),re(oe,d),d&&f(be),A&&A.d(d),d&&f(ce),Ve=!1,_e(Me)}}}function $t(r){const e=document.getElementById("backup-modal");e&&(e.showModal(),r.preventDefault())}function Ut(r,e,l){let{key:s}=e;ct();let a=[],c="",t=!0,u,n,i="";function k(){for(let B=0;B<localStorage.length;B++){const D=localStorage.key(B);if(D){let S=nt(D);a.push({name:D,key:B,size:S.words.length})}}}k();function w(){l(1,a=[]),k(),l(1,a)}function g(B,D){const S=document.getElementById(D);if(!S)return console.log("could not find id: "+D),!1;if(S.value!=""){S.setCustomValidity("");{const O=localStorage.getItem(S.value.toLowerCase());if(S.value.toLowerCase()==s.toLowerCase())S.setCustomValidity(`'${s}' is a reserved name`);else if(O!=null)S.setCustomValidity("Backup exists");else return!0}}return!1}function _(B,D){if(!g(D,s+"-rename-backup"))return console.log("invalid name:"+i),D.preventDefault(),!1;const S=document.getElementById(s+"-rename-hidden"),O=i.toLowerCase(),K=localStorage.getItem(O);if(!S||!S.value||!i||K!=null)return!1;const Y=S.value.toLowerCase(),Z=localStorage.getItem(Y);return Z?(console.log("renaming "+Y+" to "+O),localStorage.setItem(O,Z),localStorage.removeItem(Y),w(),!0):!1}function I(B,D){if(!t&&!window.confirm("This will erase the current word list, continue?"))return console.log("cancelling"),D.preventDefault(),!1;if(t&&!g(D,s+"-original-name"))return D.preventDefault(),!1;const S=document.getElementById(s+"-backup-list-form");if(S){const O=S.elements.namedItem("btn-edit"),K=localStorage.getItem(s.toLowerCase());if(!O||!K)return!1;const Y=localStorage.getItem(O.value);if(!Y)return!1;t&&localStorage.setItem(c,K),localStorage.setItem(s,Y),w()}return!0}function h(B){const D=document.getElementById(s+"-new-backup-name");if(!D||!g(B,s+"-new-backup-name")){B.preventDefault();return}const S=localStorage.getItem(s.toLowerCase());S&&(localStorage.setItem(D.value.toLowerCase(),S),w(),D.value="")}function N(B){B.preventDefault();let D=document.getElementById(`${s}-upload-backup`);if(!D||!D.files||!D.files[0]){l(4,u="Please select a file"),l(5,n="error");return}if(!window.confirm("This will overwrite the current word list, continue?"))return;const S=new FileReader;S.onload=O=>{if(!S.result){l(4,u="Upload failed"),l(5,n="error");return}let K=S.result,Y=JSON.parse(K);if(console.log(Ke(Y)),!Ke(Y)){l(4,u="Invalid backup file."),l(5,n="error");return}localStorage.setItem(s,K),l(4,u="Backup restored"),l(5,n="info");let Z=document.getElementById(`${s}-upload-backup`);Z&&(Z.value="")},S.readAsText(D.files[0])}function p(B,D){const S=document.getElementById("rename-modal");if(!S)return;const O=document.getElementById(s+"-rename-backup");O&&(O.placeholder=D);const K=document.getElementById(s+"-rename-hidden");K&&(K.value=D,S.showModal(),B.preventDefault())}function y(B,D){const S=document.getElementById(s+"-rename-backup");S&&(S.placeholder="")}function U(B,D){return B.preventDefault(),window.confirm("Delete backup '"+D+"'?")?(localStorage.removeItem(D),w(),!0):!1}const C=B=>g(B,s+"-new-backup-name"),Q=(B,D)=>U(D,B.name),H=(B,D)=>_t(B.name),X=(B,D)=>p(D,B.name),V=B=>N(B);function ie(){t=this.checked,l(3,t)}function te(){c=this.value,l(2,c)}const ee=B=>g(B,s+"-original-name"),M=B=>g(B,s+"-rename-backup");function P(){i=this.value,l(6,i)}function q(B){u=B,l(4,u)}function G(B){u=B,l(4,u)}return r.$$set=B=>{"key"in B&&l(0,s=B.key)},[s,a,c,t,u,n,i,g,_,I,h,N,p,y,U,C,Q,H,X,V,ie,te,ee,M,P,q,G]}class Ct extends we{constructor(e){super(),Ie(this,e,Ut,Nt,Be,{key:0},null,[-1,-1])}}function st(r){let e,l,s,a;const c=[Ot,Vt],t=[];function u(n,i){return n[1]!=null?0:1}return e=u(r),l=t[e]=c[e](r),{c(){l.c(),s=ue()},l(n){l.l(n),s=ue()},m(n,i){t[e].m(n,i),$(n,s,i),a=!0},p(n,i){let k=e;e=u(n),e===k?t[e].p(n,i):(De(),J(t[k],1,1,()=>{t[k]=null}),Te(),l=t[e],l?l.p(n,i):(l=t[e]=c[e](n),l.c()),F(l,1),l.m(s.parentNode,s))},i(n){a||(F(l),a=!0)},o(n){J(l),a=!1},d(n){t[e].d(n),n&&f(s)}}}function Vt(r){let e,l,s;function a(t){r[7](t)}let c={};return r[0]!==void 0&&(c.message=r[0]),e=new Ue({props:c}),Se.push(()=>Ne(e,"message",a,r[0])),{c(){le(e.$$.fragment)},l(t){se(e.$$.fragment,t)},m(t,u){ne(e,t,u),s=!0},p(t,u){const n={};!l&&u&1&&(l=!0,n.message=t[0],$e(()=>l=!1)),e.$set(n)},i(t){s||(F(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){re(e,t)}}}function Ot(r){let e,l,s;function a(t){r[6](t)}let c={alert_style:r[1]};return r[0]!==void 0&&(c.message=r[0]),e=new Ue({props:c}),Se.push(()=>Ne(e,"message",a,r[0])),{c(){le(e.$$.fragment)},l(t){se(e.$$.fragment,t)},m(t,u){ne(e,t,u),s=!0},p(t,u){const n={};u&2&&(n.alert_style=t[1]),!l&&u&1&&(l=!0,n.message=t[0],$e(()=>l=!1)),e.$set(n)},i(t){s||(F(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){re(e,t)}}}function Rt(r){let e,l,s,a,c,t,u,n,i,k,w,g,_,I,h,N,p=r[0]&&st(r);return{c(){e=b("legend"),l=j("Options"),s=R(),a=b("div"),c=b("div"),t=b("button"),u=j("Refresh All Defintions"),n=R(),i=b("div"),k=b("button"),w=j("Clear words"),g=R(),p&&p.c(),_=ue(),this.h()},l(y){e=v(y,"LEGEND",{class:!0});var U=E(e);l=z(U,"Options"),U.forEach(f),s=L(y),a=v(y,"DIV",{class:!0});var C=E(a);c=v(C,"DIV",{class:!0});var Q=E(c);t=v(Q,"BUTTON",{type:!0,class:!0});var H=E(t);u=z(H,"Refresh All Defintions"),H.forEach(f),Q.forEach(f),n=L(C),i=v(C,"DIV",{class:!0});var X=E(i);k=v(X,"BUTTON",{type:!0,class:!0});var V=E(k);w=z(V,"Clear words"),V.forEach(f),X.forEach(f),C.forEach(f),g=L(y),p&&p.l(y),_=ue(),this.h()},h(){o(e,"class","options-group-title"),o(t,"type","button"),o(t,"class","btn btn-primary"),o(c,"class","option-item svelte-13aeovf"),o(k,"type","button"),o(k,"class","btn btn-danger"),o(i,"class","option-item svelte-13aeovf"),o(a,"class","options-group")},m(y,U){$(y,e,U),m(e,l),$(y,s,U),$(y,a,U),m(a,c),m(c,t),m(t,u),m(a,n),m(a,i),m(i,k),m(k,w),$(y,g,U),p&&p.m(y,U),$(y,_,U),I=!0,h||(N=[W(t,"click",r[5]),W(k,"click",r[2])],h=!0)},p(y,[U]){y[0]?p?(p.p(y,U),U&1&&F(p,1)):(p=st(y),p.c(),F(p,1),p.m(_.parentNode,_)):p&&(De(),J(p,1,1,()=>{p=null}),Te())},i(y){I||(F(p),I=!0)},o(y){J(p),I=!1},d(y){y&&f(e),y&&f(s),y&&f(a),y&&f(g),p&&p.d(y),y&&f(_),h=!1,_e(N)}}}function Lt(r,e,l){let{key:s}=e,a,c;function t(){if(!window.confirm("This will clear all words in your word list.  Continue?"))return;const w=mt(s);Qe(w)}function u(w){function g(p,y){return p.dict_def=y.dict_def,!0}if(!w)return;let _=nt(w);if(!window.confirm(`Refresh all ${_.words.length} words?

This will overwrite existing definitions.`))return;let I=0,h=[],N=_.words.map(async p=>{try{const y=await pt.default.lookup(p.word);y?(p.dict_def=y,I+=1):h.push(p.word)}finally{p.cache=bt(p),vt(_,p,g)}});Promise.allSettled(N).then(()=>{h.length==0?(l(0,a=`Updated ${I} words`),l(1,c="info")):(l(1,c="error"),l(0,a=`Failed to update ${h.length} words.  ${h}`)),Qe(_)})}const n=()=>u("words");function i(w){a=w,l(0,a)}function k(w){a=w,l(0,a)}return r.$$set=w=>{"key"in w&&l(4,s=w.key)},[a,c,t,u,s,n,i,k]}class Mt extends we{constructor(e){super(),Ie(this,e,Lt,Rt,Be,{key:4})}}function Pt(r){let e,l,s,a,c,t,u;return e=new kt({props:{current:"options"}}),a=new Ct({props:{key:"words"}}),t=new Mt({props:{key:"words"}}),{c(){le(e.$$.fragment),l=R(),s=b("div"),le(a.$$.fragment),c=R(),le(t.$$.fragment),this.h()},l(n){se(e.$$.fragment,n),l=L(n),s=v(n,"DIV",{class:!0});var i=E(s);se(a.$$.fragment,i),c=L(i),se(t.$$.fragment,i),i.forEach(f),this.h()},h(){o(s,"class","options-page")},m(n,i){ne(e,n,i),$(n,l,i),$(n,s,i),ne(a,s,null),m(s,c),ne(t,s,null),u=!0},p:Le,i(n){u||(F(e.$$.fragment,n),F(a.$$.fragment,n),F(t.$$.fragment,n),u=!0)},o(n){J(e.$$.fragment,n),J(a.$$.fragment,n),J(t.$$.fragment,n),u=!1},d(n){re(e,n),n&&f(l),n&&f(s),re(a),re(t)}}}class jt extends we{constructor(e){super(),Ie(this,e,null,Pt,Be,{})}}export{jt as default};
