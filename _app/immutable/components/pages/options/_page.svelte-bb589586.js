import{S as Pe,i as $e,s as Ae,C as ct,k as m,a as L,q as z,l as b,m as k,c as P,r as H,h as u,n as o,b as q,G as f,M as X,_ as ft,D as dt,E as _t,F as pt,u as Re,f as Z,t as se,P as Ue,w as _e,e as ge,x as pe,y as me,X as mt,g as Me,d as Fe,z as be,R as ut,L as Le,$ as bt,J as ze,K as He,O as We,B as Ce}from"../../../chunks/index-e56e8534.js";import{q as vt,f as ht,u as kt,d as Be,v as Ne,x as gt,l as ke,y as wt,A as xe,o as et,n as tt}from"../../../chunks/words-9970dd32.js";import{A as je}from"../../../chunks/Alert-392b790a.js";import{N as yt}from"../../../chunks/Nav-34f01931.js";function Et(n){let e,l,s,r,i,t,c,a,d,v,p,w,_;const E=n[9].default,N=ct(E,n,n[8],null);return{c(){e=m("dialog"),l=m("div"),s=m("form"),N&&N.c(),r=L(),i=m("div"),t=m("button"),c=z(n[0]),a=L(),d=m("button"),v=z(n[1]),this.h()},l(D){e=b(D,"DIALOG",{class:!0,id:!0});var g=k(e);l=b(g,"DIV",{class:!0});var O=k(l);s=b(O,"FORM",{method:!0});var j=k(s);N&&N.l(j),r=P(j),i=b(j,"DIV",{class:!0});var A=k(i);t=b(A,"BUTTON",{type:!0,class:!0});var V=k(t);c=H(V,n[0]),V.forEach(u),a=P(A),d=b(A,"BUTTON",{type:!0,class:!0});var U=k(d);v=H(U,n[1]),U.forEach(u),A.forEach(u),j.forEach(u),O.forEach(u),g.forEach(u),this.h()},h(){o(t,"type","submit"),o(t,"class","btn btn-primary"),o(d,"type","button"),o(d,"class","btn btn-secondary"),o(i,"class","dialog-controls svelte-1d7zp56"),o(s,"method","dialog"),o(l,"class","modal-wrapper svelte-1d7zp56"),o(e,"class","modal svelte-1d7zp56"),o(e,"id",n[2])},m(D,g){q(D,e,g),f(e,l),f(l,s),N&&N.m(s,null),f(s,r),f(s,i),f(i,t),f(t,c),f(i,a),f(i,d),f(d,v),p=!0,w||(_=[X(d,"click",n[3]),X(s,"submit",n[5]),X(e,"click",ft(n[3])),X(e,"close",n[4])],w=!0)},p(D,[g]){N&&N.p&&(!p||g&256)&&dt(N,E,D,D[8],p?pt(E,D[8],g,null):_t(D[8]),null),(!p||g&1)&&Re(c,D[0]),(!p||g&2)&&Re(v,D[1]),(!p||g&4)&&o(e,"id",D[2])},i(D){p||(Z(N,D),p=!0)},o(D){se(N,D),p=!1},d(D){D&&u(e),N&&N.d(D),w=!1,Ue(_)}}}function lt(n){n.querySelectorAll("form").forEach(e=>{e.reset()})}function It(n,e,l){let{$$slots:s={},$$scope:r}=e,{onClose:i=()=>{}}=e,{onSubmit:t}=e,{submit_text:c="Submit"}=e,{cancel_text:a="Cancel"}=e,{id:d}=e;function v(_){const E=document.getElementById(d);E&&(i(E,_),lt(E),E.close())}function p(_){const E=document.getElementById(d);E&&(i(E,_),lt(E))}function w(_){const E=document.getElementById(d);if(!E){_.preventDefault();return}t(E,_)?E.close():_.preventDefault()}return n.$$set=_=>{"onClose"in _&&l(6,i=_.onClose),"onSubmit"in _&&l(7,t=_.onSubmit),"submit_text"in _&&l(0,c=_.submit_text),"cancel_text"in _&&l(1,a=_.cancel_text),"id"in _&&l(2,d=_.id),"$$scope"in _&&l(8,r=_.$$scope)},[c,a,d,v,p,w,i,t,r,s]}class st extends Pe{constructor(e){super(),$e(this,e,It,Et,Ae,{onClose:6,onSubmit:7,submit_text:0,cancel_text:1,id:2})}}function rt(n,e,l){const s=n.slice();return s[30]=e[l],s}function Bt(n){let e,l;return{c(){e=m("button"),l=m("i"),this.h()},l(s){e=b(s,"BUTTON",{type:!0,class:!0});var r=k(e);l=b(r,"I",{class:!0}),k(l).forEach(u),r.forEach(u),this.h()},h(){o(l,"class","fa-solid fa-xmark"),o(e,"type","button"),o(e,"class","remove-btn svelte-twqcit"),e.disabled=!0},m(s,r){q(s,e,r),f(e,l)},p:Ce,d(s){s&&u(e)}}}function Tt(n){let e,l,s,r;function i(...t){return n[17](n[30],...t)}return{c(){e=m("button"),l=m("i"),this.h()},l(t){e=b(t,"BUTTON",{type:!0,class:!0,title:!0});var c=k(e);l=b(c,"I",{class:!0}),k(l).forEach(u),c.forEach(u),this.h()},h(){o(l,"class","fa-solid fa-xmark"),o(e,"type","button"),o(e,"class","remove-btn svelte-twqcit"),o(e,"title","Delete backup")},m(t,c){q(t,e,c),f(e,l),s||(r=X(e,"click",i),s=!0)},p(t,c){n=t},d(t){t&&u(e),s=!1,r()}}}function Dt(n){let e,l,s,r;return{c(){e=m("button"),l=m("i"),s=L(),r=m("input"),this.h()},l(i){e=b(i,"BUTTON",{type:!0,class:!0});var t=k(e);l=b(t,"I",{class:!0}),k(l).forEach(u),t.forEach(u),s=P(i),r=b(i,"INPUT",{type:!0,class:!0}),this.h()},h(){o(l,"class","fa-solid fa-pen"),o(e,"type","button"),e.disabled=!0,o(e,"class","btn rename-btn svelte-twqcit"),o(r,"type","radio"),o(r,"class","btn-edit-current svelte-twqcit"),r.disabled=!0},m(i,t){q(i,e,t),f(e,l),q(i,s,t),q(i,r,t)},p:Ce,d(i){i&&u(e),i&&u(s),i&&u(r)}}}function qt(n){let e,l,s,r,i,t,c,a,d,v;function p(...w){return n[19](n[30],...w)}return{c(){e=m("button"),l=m("i"),i=L(),t=m("input"),this.h()},l(w){e=b(w,"BUTTON",{type:!0,id:!0,title:!0,class:!0});var _=k(e);l=b(_,"I",{class:!0}),k(l).forEach(u),_.forEach(u),i=P(w),t=b(w,"INPUT",{type:!0,name:!0,class:!0,title:!0,id:!0}),this.h()},h(){o(l,"class","fa-solid fa-pen"),o(e,"type","submit"),o(e,"id",s=n[0]+"-backup-rename-"+n[30].name),o(e,"title","Rename"),e.value=r=n[30].name,o(e,"class","btn rename-btn svelte-twqcit"),o(t,"type","radio"),o(t,"name","btn-edit"),o(t,"class","btn-edit svelte-twqcit"),o(t,"title","Select this backup for restore"),o(t,"id",c=n[0]+"-restore-"+n[30].key),t.required=!0,t.value=a=n[30].name},m(w,_){q(w,e,_),f(e,l),q(w,i,_),q(w,t,_),d||(v=X(e,"click",p),d=!0)},p(w,_){n=w,_[0]&3&&s!==(s=n[0]+"-backup-rename-"+n[30].name)&&o(e,"id",s),_[0]&2&&r!==(r=n[30].name)&&(e.value=r),_[0]&3&&c!==(c=n[0]+"-restore-"+n[30].key)&&o(t,"id",c),_[0]&2&&a!==(a=n[30].name)&&(t.value=a)},d(w){w&&u(e),w&&u(i),w&&u(t),d=!1,v()}}}function Nt(n){let e=n[30].name+"",l;return{c(){l=z(e)},l(s){l=H(s,e)},m(s,r){q(s,l,r)},p(s,r){r[0]&2&&e!==(e=s[30].name+"")&&Re(l,e)},d(s){s&&u(l)}}}function Ut(n){let e,l;return{c(){e=m("div"),l=z("Current"),this.h()},l(s){e=b(s,"DIV",{class:!0});var r=k(e);l=H(r,"Current"),r.forEach(u),this.h()},h(){o(e,"class","backup-current svelte-twqcit")},m(s,r){q(s,e,r),f(e,l)},p:Ce,d(s){s&&u(e)}}}function nt(n,e){let l,s,r,i,t,c,a,d,v,p,w,_,E,N=e[30].size+"",D,g,O,j;function A(S,W){return S[30].name!=S[0]?Tt:Bt}let V=A(e),U=V(e);function R(...S){return e[18](e[30],...S)}function J(S,W){return S[30].name!=S[0]?qt:Dt}let te=J(e),$=te(e);function ne(S,W){return S[30].name==S[0]?Ut:Nt}let x=ne(e),Y=x(e);return{key:n,first:null,c(){l=m("div"),s=m("div"),U.c(),r=L(),i=m("button"),t=m("i"),c=L(),$.c(),a=L(),d=m("div"),v=m("label"),Y.c(),w=L(),_=m("div"),E=z("("),D=z(N),g=z(" words)"),this.h()},l(S){l=b(S,"DIV",{class:!0});var W=k(l);s=b(W,"DIV",{class:!0});var Q=k(s);U.l(Q),r=P(Q),i=b(Q,"BUTTON",{type:!0,class:!0,title:!0});var B=k(i);t=b(B,"I",{class:!0}),k(t).forEach(u),B.forEach(u),c=P(Q),$.l(Q),a=P(Q),d=b(Q,"DIV",{class:!0});var y=k(d);v=b(y,"LABEL",{class:!0,for:!0,title:!0});var T=k(v);Y.l(T),T.forEach(u),w=P(y),_=b(y,"DIV",{class:!0});var M=k(_);E=H(M,"("),D=H(M,N),g=H(M," words)"),M.forEach(u),y.forEach(u),Q.forEach(u),W.forEach(u),this.h()},h(){o(t,"class","fa-solid fa-download"),o(i,"type","button"),o(i,"class","btn download-btn svelte-twqcit"),o(i,"title","Download backup"),o(v,"class","backup-name-label svelte-twqcit"),o(v,"for",p=e[0]+"-restore-"+e[30].key),o(v,"title","Select backup for restore"),o(_,"class","backup-length svelte-twqcit"),o(d,"class","backup-name svelte-twqcit"),o(s,"class","backup-content svelte-twqcit"),o(l,"class","backup-entry svelte-twqcit"),this.first=l},m(S,W){q(S,l,W),f(l,s),U.m(s,null),f(s,r),f(s,i),f(i,t),f(s,c),$.m(s,null),f(s,a),f(s,d),f(d,v),Y.m(v,null),f(d,w),f(d,_),f(_,E),f(_,D),f(_,g),O||(j=X(i,"click",R),O=!0)},p(S,W){e=S,V===(V=A(e))&&U?U.p(e,W):(U.d(1),U=V(e),U&&(U.c(),U.m(s,r))),te===(te=J(e))&&$?$.p(e,W):($.d(1),$=te(e),$&&($.c(),$.m(s,a))),x===(x=ne(e))&&Y?Y.p(e,W):(Y.d(1),Y=x(e),Y&&(Y.c(),Y.m(v,null))),W[0]&3&&p!==(p=e[0]+"-restore-"+e[30].key)&&o(v,"for",p),W[0]&2&&N!==(N=e[30].size+"")&&Re(D,N)},d(S){S&&u(l),U.d(),$.d(),Y.d(),O=!1,j()}}}function ot(n){let e,l,s,r,i;return{c(){e=z(`Backup as:
                `),l=m("input"),this.h()},l(t){e=H(t,`Backup as:
                `),l=b(t,"INPUT",{id:!0,name:!0,type:!0,class:!0,placeholder:!0}),this.h()},h(){o(l,"id",s=n[0]+"-original-name"),o(l,"name","save-as"),o(l,"type","text"),o(l,"class","original form-control svelte-twqcit"),o(l,"placeholder","new name"),l.required=!0},m(t,c){q(t,e,c),q(t,l,c),Le(l,n[4]),r||(i=[X(l,"input",n[22]),X(l,"blur",n[23])],r=!0)},p(t,c){c[0]&1&&s!==(s=t[0]+"-original-name")&&o(l,"id",s),c[0]&16&&l.value!==t[4]&&Le(l,t[4])},d(t){t&&u(e),t&&u(l),r=!1,Ue(i)}}}function Ct(n){let e,l,s,r,i,t,c,a,d,v,p,w,_=n[5]&&ot(n);return{c(){e=m("div"),l=m("div"),s=m("input"),i=L(),t=m("label"),c=z("Backup current list"),d=L(),v=m("div"),_&&_.c(),this.h()},l(E){e=b(E,"DIV",{class:!0});var N=k(e);l=b(N,"DIV",{class:!0});var D=k(l);s=b(D,"INPUT",{type:!0,id:!0}),i=P(D),t=b(D,"LABEL",{for:!0});var g=k(t);c=H(g,"Backup current list"),g.forEach(u),D.forEach(u),d=P(N),v=b(N,"DIV",{});var O=k(v);_&&_.l(O),O.forEach(u),N.forEach(u),this.h()},h(){o(s,"type","checkbox"),o(s,"id",r=n[0]+"-rename-current"),o(t,"for",a=n[0]+"-rename-current"),o(l,"class","dialog-title svelte-twqcit"),o(e,"class","original-name svelte-twqcit")},m(E,N){q(E,e,N),f(e,l),f(l,s),s.checked=n[5],f(l,i),f(l,t),f(t,c),f(e,d),f(e,v),_&&_.m(v,null),p||(w=X(s,"change",n[21]),p=!0)},p(E,N){N[0]&1&&r!==(r=E[0]+"-rename-current")&&o(s,"id",r),N[0]&32&&(s.checked=E[5]),N[0]&1&&a!==(a=E[0]+"-rename-current")&&o(t,"for",a),E[5]?_?_.p(E,N):(_=ot(E),_.c(),_.m(v,null)):_&&(_.d(1),_=null)},d(E){E&&u(e),_&&_.d(),p=!1,w()}}}function St(n){let e,l,s,r,i,t,c;return{c(){e=m("input"),s=L(),r=m("input"),this.h()},l(a){e=b(a,"INPUT",{type:!0,id:!0,class:!0}),s=P(a),r=b(a,"INPUT",{type:!0,id:!0}),this.h()},h(){o(e,"type","text"),o(e,"id",l=n[0]+"-rename-backup"),o(e,"class","form-control"),o(r,"type","hidden"),o(r,"id",i=n[0]+"-rename-hidden")},m(a,d){q(a,e,d),Le(e,n[6]),q(a,s,d),q(a,r,d),t||(c=[X(e,"blur",n[24]),X(e,"input",n[25])],t=!0)},p(a,d){d[0]&1&&l!==(l=a[0]+"-rename-backup")&&o(e,"id",l),d[0]&64&&e.value!==a[6]&&Le(e,a[6]),d[0]&1&&i!==(i=a[0]+"-rename-hidden")&&o(r,"id",i)},d(a){a&&u(e),a&&u(s),a&&u(r),t=!1,Ue(c)}}}function it(n){let e,l,s,r;const i=[Vt,Ot],t=[];function c(a,d){return a[3]!=null?0:1}return e=c(n),l=t[e]=i[e](n),{c(){l.c(),s=ge()},l(a){l.l(a),s=ge()},m(a,d){t[e].m(a,d),q(a,s,d),r=!0},p(a,d){let v=e;e=c(a),e===v?t[e].p(a,d):(Me(),se(t[v],1,1,()=>{t[v]=null}),Fe(),l=t[e],l?l.p(a,d):(l=t[e]=i[e](a),l.c()),Z(l,1),l.m(s.parentNode,s))},i(a){r||(Z(l),r=!0)},o(a){se(l),r=!1},d(a){t[e].d(a),a&&u(s)}}}function Ot(n){let e,l,s;function r(t){n[27](t)}let i={};return n[2]!==void 0&&(i.message=n[2]),e=new je({props:i}),ze.push(()=>He(e,"message",r,n[2])),{c(){_e(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,c){me(e,t,c),s=!0},p(t,c){const a={};!l&&c[0]&4&&(l=!0,a.message=t[2],We(()=>l=!1)),e.$set(a)},i(t){s||(Z(e.$$.fragment,t),s=!0)},o(t){se(e.$$.fragment,t),s=!1},d(t){be(e,t)}}}function Vt(n){let e,l,s;function r(t){n[26](t)}let i={alert_style:n[3]};return n[2]!==void 0&&(i.message=n[2]),e=new je({props:i}),ze.push(()=>He(e,"message",r,n[2])),{c(){_e(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,c){me(e,t,c),s=!0},p(t,c){const a={};c[0]&8&&(a.alert_style=t[3]),!l&&c[0]&4&&(l=!0,a.message=t[2],We(()=>l=!1)),e.$set(a)},i(t){s||(Z(e.$$.fragment,t),s=!0)},o(t){se(e.$$.fragment,t),s=!1},d(t){be(e,t)}}}function Rt(n){let e,l,s,r,i,t,c,a,d,v,p,w,_,E,N,D,g,O,j,A,V,U=[],R=new Map,J,te,$,ne,x,Y,S,W,Q,B,y,T,M,le,ie,re,ae,we,ue,oe,F,I,G,ce,ve,de,ye=n[1];const Te=h=>h[30].key;for(let h=0;h<ye.length;h+=1){let C=rt(n,ye,h),ee=Te(C);R.set(ee,U[h]=nt(ee,C))}ue=new st({props:{id:"backup-modal",onSubmit:n[9],submit_text:"Restore",$$slots:{default:[Ct]},$$scope:{ctx:n}}}),F=new st({props:{id:"rename-modal",onSubmit:n[8],onClose:n[14],submit_text:"Rename",$$slots:{default:[St]},$$scope:{ctx:n}}});let K=n[2]&&it(n);return{c(){e=m("h2"),l=z("Backups"),s=L(),r=m("div"),i=m("div"),t=m("h3"),c=z("Create Backup"),a=L(),d=m("form"),v=m("div"),p=m("input"),_=L(),E=m("button"),N=z("Create Backup"),D=L(),g=m("div"),O=m("h3"),j=z("Restore Backup"),A=L(),V=m("form");for(let h=0;h<U.length;h+=1)U[h].c();J=L(),te=m("div"),$=m("button"),ne=z("Restore"),Y=L(),S=m("div"),W=m("h3"),Q=z("Upload Backup"),B=L(),y=m("form"),T=m("div"),M=m("input"),ie=L(),re=m("button"),ae=z("Restore Backup"),we=L(),_e(ue.$$.fragment),oe=L(),_e(F.$$.fragment),I=L(),K&&K.c(),G=ge(),this.h()},l(h){e=b(h,"H2",{class:!0,id:!0});var C=k(e);l=H(C,"Backups"),C.forEach(u),s=P(h),r=b(h,"DIV",{class:!0});var ee=k(r);i=b(ee,"DIV",{class:!0});var fe=k(i);t=b(fe,"H3",{class:!0,id:!0});var De=k(t);c=H(De,"Create Backup"),De.forEach(u),a=P(fe),d=b(fe,"FORM",{class:!0});var Ee=k(d);v=b(Ee,"DIV",{class:!0});var he=k(v);p=b(he,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),_=P(he),E=b(he,"BUTTON",{class:!0});var qe=k(E);N=H(qe,"Create Backup"),qe.forEach(u),he.forEach(u),Ee.forEach(u),fe.forEach(u),D=P(ee),g=b(ee,"DIV",{class:!0});var Ie=k(g);O=b(Ie,"H3",{class:!0,id:!0});var Je=k(O);j=H(Je,"Restore Backup"),Je.forEach(u),A=P(Ie),V=b(Ie,"FORM",{id:!0,class:!0});var Se=k(V);for(let Ge=0;Ge<U.length;Ge+=1)U[Ge].l(Se);J=P(Se),te=b(Se,"DIV",{class:!0});var Ke=k(te);$=b(Ke,"BUTTON",{type:!0,class:!0,name:!0});var Xe=k($);ne=H(Xe,"Restore"),Xe.forEach(u),Ke.forEach(u),Se.forEach(u),Ie.forEach(u),Y=P(ee),S=b(ee,"DIV",{class:!0});var Oe=k(S);W=b(Oe,"H3",{class:!0,id:!0});var Qe=k(W);Q=H(Qe,"Upload Backup"),Qe.forEach(u),B=P(Oe),y=b(Oe,"FORM",{class:!0});var Ye=k(y);T=b(Ye,"DIV",{class:!0});var Ve=k(T);M=b(Ve,"INPUT",{id:!0,class:!0,type:!0,accept:!0}),ie=P(Ve),re=b(Ve,"BUTTON",{class:!0});var Ze=k(re);ae=H(Ze,"Restore Backup"),Ze.forEach(u),Ve.forEach(u),Ye.forEach(u),Oe.forEach(u),ee.forEach(u),we=P(h),pe(ue.$$.fragment,h),oe=P(h),pe(F.$$.fragment,h),I=P(h),K&&K.l(h),G=ge(),this.h()},h(){o(e,"class","options-group-title"),o(e,"id","create-backup"),o(t,"class","options-group-title svelte-twqcit"),o(t,"id","create-backup"),o(p,"id",w=n[0]+"-new-backup-name"),o(p,"type","text"),o(p,"class","new-backup-name form-control svelte-twqcit"),o(p,"placeholder","new name"),o(E,"class","create-backup btn btn-primary svelte-twqcit"),o(v,"class","new-backup svelte-twqcit"),o(d,"class","svelte-twqcit"),o(i,"class","backup-group svelte-twqcit"),o(O,"class","options-group-title svelte-twqcit"),o(O,"id","backups"),o($,"type","button"),o($,"class","btn btn-danger"),o($,"name","backups_action"),$.value="restore",o(te,"class","backup-submit svelte-twqcit"),o(V,"id",x=n[0]+"-backup-list-form"),o(V,"class","svelte-twqcit"),o(g,"class","backup-group svelte-twqcit"),o(W,"class","options-group-title svelte-twqcit"),o(W,"id","upload-backup"),o(M,"id",le=n[0]+"-upload-backup"),o(M,"class","upload-backup form-control svelte-twqcit"),o(M,"type","file"),o(M,"accept",".json,application/json"),o(re,"class","btn btn-danger upload-backup-btn svelte-twqcit"),o(T,"class","new-backup svelte-twqcit"),o(y,"class","svelte-twqcit"),o(S,"class","backup-group svelte-twqcit"),o(r,"class","options-group")},m(h,C){q(h,e,C),f(e,l),q(h,s,C),q(h,r,C),f(r,i),f(i,t),f(t,c),f(i,a),f(i,d),f(d,v),f(v,p),f(v,_),f(v,E),f(E,N),f(r,D),f(r,g),f(g,O),f(O,j),f(g,A),f(g,V);for(let ee=0;ee<U.length;ee+=1)U[ee].m(V,null);f(V,J),f(V,te),f(te,$),f($,ne),f(r,Y),f(r,S),f(S,W),f(W,Q),f(S,B),f(S,y),f(y,T),f(T,M),f(T,ie),f(T,re),f(re,ae),q(h,we,C),me(ue,h,C),q(h,oe,C),me(F,h,C),q(h,I,C),K&&K.m(h,C),q(h,G,C),ce=!0,ve||(de=[X(p,"blur",n[16]),X(d,"submit",n[10]),X($,"click",n[12]),X(y,"submit",n[20])],ve=!0)},p(h,C){(!ce||C[0]&1&&w!==(w=h[0]+"-new-backup-name"))&&o(p,"id",w),C[0]&40963&&(ye=h[1],U=mt(U,C,Te,1,h,ye,R,V,bt,nt,J,rt)),(!ce||C[0]&1&&x!==(x=h[0]+"-backup-list-form"))&&o(V,"id",x),(!ce||C[0]&1&&le!==(le=h[0]+"-upload-backup"))&&o(M,"id",le);const ee={};C[0]&49|C[1]&4&&(ee.$$scope={dirty:C,ctx:h}),ue.$set(ee);const fe={};C[0]&65|C[1]&4&&(fe.$$scope={dirty:C,ctx:h}),F.$set(fe),h[2]?K?(K.p(h,C),C[0]&4&&Z(K,1)):(K=it(h),K.c(),Z(K,1),K.m(G.parentNode,G)):K&&(Me(),se(K,1,1,()=>{K=null}),Fe())},i(h){ce||(Z(ue.$$.fragment,h),Z(F.$$.fragment,h),Z(K),ce=!0)},o(h){se(ue.$$.fragment,h),se(F.$$.fragment,h),se(K),ce=!1},d(h){h&&u(e),h&&u(s),h&&u(r);for(let C=0;C<U.length;C+=1)U[C].d();h&&u(we),be(ue,h),h&&u(oe),be(F,h),h&&u(I),K&&K.d(h),h&&u(G),ve=!1,Ue(de)}}}function Lt(n,e,l){const s=ut();let{key:r}=e,{backups:i}=e,t,c,a="",d=!0,v="";function p(){s("refreshlist",!0)}function w(B,y){const T=document.getElementById(y);if(!T)return!1;if(T.value!=""){T.setCustomValidity("");{const M=localStorage.getItem(T.value.toLowerCase());if(T.value.toLowerCase()==r.toLowerCase())T.setCustomValidity(`'${r}' is a reserved name`);else if(M!=null)T.setCustomValidity("Backup exists");else return!0}}return!1}function _(B,y){if(!w(y,r+"-rename-backup"))return console.log("invalid name:"+v),y.preventDefault(),!1;const T=document.getElementById(r+"-rename-hidden"),M=v.toLowerCase(),le=localStorage.getItem(M);if(!T||!T.value||!v||le!=null)return!1;const ie=T.value.toLowerCase(),re=localStorage.getItem(ie);return re?(localStorage.setItem(M,re),localStorage.removeItem(ie),p(),!0):!1}function E(B,y){if(!d&&!window.confirm("This will erase the current word list, continue?"))return console.log("cancelling"),y.preventDefault(),!1;if(d&&!w(y,r+"-original-name"))return y.preventDefault(),!1;const T=document.getElementById(r+"-backup-list-form");if(T){const M=T.elements.namedItem("btn-edit"),le=localStorage.getItem(r.toLowerCase());if(!M||!le)return!1;const ie=localStorage.getItem(M.value);if(!ie)return!1;d&&localStorage.setItem(a,le),localStorage.setItem(r,ie),l(2,t="Backup restored"),l(3,c="info"),p()}return!0}function N(B){const y=document.getElementById(r+"-new-backup-name");if(!y||!w(B,r+"-new-backup-name")){B.preventDefault();return}const T=localStorage.getItem(r.toLowerCase());T&&(localStorage.setItem(y.value.toLowerCase(),T),l(2,t="Backup created"),l(3,c="info"),p(),y.value="")}function D(B){B.preventDefault();let y=document.getElementById(`${r}-upload-backup`);if(!y||!y.files||!y.files[0]){l(2,t="Please select a file"),l(3,c="error");return}if(!window.confirm("This will overwrite the current word list, continue?"))return;const T=new FileReader;T.onload=M=>{if(!T.result){l(2,t="Upload failed"),l(3,c="error");return}let le=T.result,ie=JSON.parse(le);if(!vt(ie)){l(2,t="Invalid backup file."),l(3,c="error");return}localStorage.setItem(r,le),l(2,t="Backup restored"),l(3,c="info");let re=document.getElementById(`${r}-upload-backup`);re&&(re.value=""),p()},T.readAsText(y.files[0])}function g(B){const y=document.getElementById("backup-modal");if(!y)return;const T=document.getElementById(`${r}-backup-list-form`);T&&T.querySelectorAll('input[name="btn-edit"]:checked').length===0||(y.showModal(),B.preventDefault())}function O(B,y){const T=document.getElementById("rename-modal");if(!T)return;const M=document.getElementById(r+"-rename-backup");M&&(M.placeholder=y);const le=document.getElementById(r+"-rename-hidden");le&&(le.value=y,T.showModal(),B.preventDefault())}function j(B,y){const T=document.getElementById(r+"-rename-backup");T&&(T.placeholder="")}function A(B,y){return B.preventDefault(),window.confirm("Delete backup '"+y+"'?")?(l(2,t="Backup deleted"),l(3,c="error"),localStorage.removeItem(y),p(),!0):!1}const V=B=>w(B,r+"-new-backup-name"),U=(B,y)=>A(y,B.name),R=(B,y)=>ht(B.name),J=(B,y)=>O(y,B.name),te=B=>D(B);function $(){d=this.checked,l(5,d)}function ne(){a=this.value,l(4,a)}const x=B=>w(B,r+"-original-name"),Y=B=>w(B,r+"-rename-backup");function S(){v=this.value,l(6,v)}function W(B){t=B,l(2,t)}function Q(B){t=B,l(2,t)}return n.$$set=B=>{"key"in B&&l(0,r=B.key),"backups"in B&&l(1,i=B.backups)},[r,i,t,c,a,d,v,w,_,E,N,D,g,O,j,A,V,U,R,J,te,$,ne,x,Y,S,W,Q]}class Pt extends Pe{constructor(e){super(),$e(this,e,Lt,Rt,Ae,{key:0,backups:1},null,[-1,-1])}}function $t(n){let e;return{c(){e=z("off")},l(l){e=H(l,"off")},m(l,s){q(l,e,s)},d(l){l&&u(e)}}}function At(n){let e;return{c(){e=z("on")},l(l){e=H(l,"on")},m(l,s){q(l,e,s)},d(l){l&&u(e)}}}function Mt(n){let e,l,s,r;return{c(){e=m("button"),l=z("Turn on"),this.h()},l(i){e=b(i,"BUTTON",{class:!0});var t=k(e);l=H(t,"Turn on"),t.forEach(u),this.h()},h(){o(e,"class","btn btn-primary svelte-vgvckc")},m(i,t){q(i,e,t),f(e,l),s||(r=X(e,"click",n[8]),s=!0)},p:Ce,d(i){i&&u(e),s=!1,r()}}}function Ft(n){let e,l,s,r;return{c(){e=m("button"),l=z("Turn off"),this.h()},l(i){e=b(i,"BUTTON",{class:!0});var t=k(e);l=H(t,"Turn off"),t.forEach(u),this.h()},h(){o(e,"class","btn btn-primary svelte-vgvckc")},m(i,t){q(i,e,t),f(e,l),s||(r=X(e,"click",n[9]),s=!0)},p:Ce,d(i){i&&u(e),s=!1,r()}}}function at(n){let e,l,s,r;const i=[Ht,zt],t=[];function c(a,d){return a[2]!=null?0:1}return e=c(n),l=t[e]=i[e](n),{c(){l.c(),s=ge()},l(a){l.l(a),s=ge()},m(a,d){t[e].m(a,d),q(a,s,d),r=!0},p(a,d){let v=e;e=c(a),e===v?t[e].p(a,d):(Me(),se(t[v],1,1,()=>{t[v]=null}),Fe(),l=t[e],l?l.p(a,d):(l=t[e]=i[e](a),l.c()),Z(l,1),l.m(s.parentNode,s))},i(a){r||(Z(l),r=!0)},o(a){se(l),r=!1},d(a){t[e].d(a),a&&u(s)}}}function zt(n){let e,l,s;function r(t){n[12](t)}let i={};return n[1]!==void 0&&(i.message=n[1]),e=new je({props:i}),ze.push(()=>He(e,"message",r,n[1])),{c(){_e(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,c){me(e,t,c),s=!0},p(t,c){const a={};!l&&c&2&&(l=!0,a.message=t[1],We(()=>l=!1)),e.$set(a)},i(t){s||(Z(e.$$.fragment,t),s=!0)},o(t){se(e.$$.fragment,t),s=!1},d(t){be(e,t)}}}function Ht(n){let e,l,s;function r(t){n[11](t)}let i={alert_style:n[2]};return n[1]!==void 0&&(i.message=n[1]),e=new je({props:i}),ze.push(()=>He(e,"message",r,n[1])),{c(){_e(e.$$.fragment)},l(t){pe(e.$$.fragment,t)},m(t,c){me(e,t,c),s=!0},p(t,c){const a={};c&4&&(a.alert_style=t[2]),!l&&c&2&&(l=!0,a.message=t[1],We(()=>l=!1)),e.$set(a)},i(t){s||(Z(e.$$.fragment,t),s=!0)},o(t){se(e.$$.fragment,t),s=!1},d(t){be(e,t)}}}function Wt(n){let e,l,s,r,i,t,c,a,d,v,p,w,_,E,N,D,g,O,j,A,V,U,R,J,te,$,ne,x,Y,S,W,Q,B,y,T,M,le;function ie(I,G){return I[0]===!0?At:$t}let re=ie(n),ae=re(n);function we(I,G){return I[0]?Ft:Mt}let ue=we(n),oe=ue(n),F=n[1]&&at(n);return{c(){e=m("h2"),l=z("Options"),s=L(),r=m("div"),i=m("div"),t=m("div"),c=m("button"),a=z("Find new definitions"),d=L(),v=m("button"),p=z("Refresh all defintions"),w=L(),_=m("button"),E=z("Clear definitions"),N=L(),D=m("div"),g=m("button"),O=z("Restore defaults"),j=L(),A=m("button"),V=z("Clear words"),U=L(),R=m("h2"),J=z("Dictionary Lookup"),te=L(),$=m("div"),ne=m("div"),x=m("p"),Y=z("Automatic dictionary lookup is: "),S=m("b"),ae.c(),W=L(),Q=m("div"),oe.c(),B=L(),F&&F.c(),y=ge(),this.h()},l(I){e=b(I,"H2",{class:!0,id:!0});var G=k(e);l=H(G,"Options"),G.forEach(u),s=P(I),r=b(I,"DIV",{class:!0});var ce=k(r);i=b(ce,"DIV",{class:!0});var ve=k(i);t=b(ve,"DIV",{class:!0});var de=k(t);c=b(de,"BUTTON",{type:!0,class:!0});var ye=k(c);a=H(ye,"Find new definitions"),ye.forEach(u),d=P(de),v=b(de,"BUTTON",{type:!0,class:!0});var Te=k(v);p=H(Te,"Refresh all defintions"),Te.forEach(u),w=P(de),_=b(de,"BUTTON",{type:!0,class:!0});var K=k(_);E=H(K,"Clear definitions"),K.forEach(u),de.forEach(u),N=P(ve),D=b(ve,"DIV",{class:!0});var h=k(D);g=b(h,"BUTTON",{type:!0,class:!0});var C=k(g);O=H(C,"Restore defaults"),C.forEach(u),j=P(h),A=b(h,"BUTTON",{type:!0,class:!0});var ee=k(A);V=H(ee,"Clear words"),ee.forEach(u),h.forEach(u),ve.forEach(u),ce.forEach(u),U=P(I),R=b(I,"H2",{class:!0,id:!0});var fe=k(R);J=H(fe,"Dictionary Lookup"),fe.forEach(u),te=P(I),$=b(I,"DIV",{class:!0});var De=k($);ne=b(De,"DIV",{});var Ee=k(ne);x=b(Ee,"P",{class:!0});var he=k(x);Y=H(he,"Automatic dictionary lookup is: "),S=b(he,"B",{});var qe=k(S);ae.l(qe),qe.forEach(u),he.forEach(u),W=P(Ee),Q=b(Ee,"DIV",{class:!0});var Ie=k(Q);oe.l(Ie),Ie.forEach(u),Ee.forEach(u),De.forEach(u),B=P(I),F&&F.l(I),y=ge(),this.h()},h(){o(e,"class","options-group-title"),o(e,"id","options"),o(c,"type","button"),o(c,"class","btn btn-primary svelte-vgvckc"),o(v,"type","button"),o(v,"class","btn btn-primary svelte-vgvckc"),o(_,"type","button"),o(_,"class","btn btn-primary svelte-vgvckc"),o(t,"class","options-subgroup svelte-vgvckc"),o(g,"type","button"),o(g,"class","btn btn-danger svelte-vgvckc"),o(A,"type","button"),o(A,"class","btn btn-danger svelte-vgvckc"),o(D,"class","option-section options-subgroup svelte-vgvckc"),o(i,"class","option-section options-group-cols svelte-vgvckc"),o(r,"class","options-group"),o(R,"class","options-group-title"),o(R,"id","dictionary-lookup"),o(x,"class","svelte-vgvckc"),o(Q,"class","toggle-autodefs svelte-vgvckc"),o($,"class","options-group svelte-vgvckc")},m(I,G){q(I,e,G),f(e,l),q(I,s,G),q(I,r,G),f(r,i),f(i,t),f(t,c),f(c,a),f(t,d),f(t,v),f(v,p),f(t,w),f(t,_),f(_,E),f(i,N),f(i,D),f(D,g),f(g,O),f(D,j),f(D,A),f(A,V),q(I,U,G),q(I,R,G),f(R,J),q(I,te,G),q(I,$,G),f($,ne),f(ne,x),f(x,Y),f(x,S),ae.m(S,null),f(ne,W),f(ne,Q),oe.m(Q,null),q(I,B,G),F&&F.m(I,G),q(I,y,G),T=!0,M||(le=[X(c,"click",n[7]),X(v,"click",n[6]),X(_,"click",n[5]),X(g,"click",n[3]),X(A,"click",n[4])],M=!0)},p(I,[G]){re!==(re=ie(I))&&(ae.d(1),ae=re(I),ae&&(ae.c(),ae.m(S,null))),ue===(ue=we(I))&&oe?oe.p(I,G):(oe.d(1),oe=ue(I),oe&&(oe.c(),oe.m(Q,null))),I[1]?F?(F.p(I,G),G&2&&Z(F,1)):(F=at(I),F.c(),Z(F,1),F.m(y.parentNode,y)):F&&(Me(),se(F,1,1,()=>{F=null}),Fe())},i(I){T||(Z(F),T=!0)},o(I){se(F),T=!1},d(I){I&&u(e),I&&u(s),I&&u(r),I&&u(U),I&&u(R),I&&u(te),I&&u($),ae.d(),oe.d(),I&&u(B),F&&F.d(I),I&&u(y),M=!1,Ue(le)}}}function jt(n,e,l){const s=ut();let{key:r}=e,{autodefs:i}=e,t,c;function a(g){if(!window.confirm("This will replace the current word list with the defaults.  Continue?"))return;const O=kt(r);Be(O),Ne(g),s("refreshlist",!0)}function d(g){if(!window.confirm("This will clear all words in your current word list.  Continue?"))return;const O=gt(r);Be(O),Ne(g),s("refreshlist",!0)}function v(g){if(!window.confirm("This will clear all words in your current word list.  Continue?"))return;let O=ke(r);wt(O),Be(O),Ne(g)}function p(g){function O(R,J){return R.dict_def=J.dict_def,!0}if(!r)return;let j=ke(r);if(!window.confirm(`Refresh all ${j.words.length} words?

This will overwrite existing definitions.`))return;let A=0,V=[],U=j.words.map(async R=>{try{const J=await xe.default.lookup(R.word);J?(R.dict_def=J,A+=1):V.push(R.word)}finally{R.cache=et(R),tt(j,R,O)}});Promise.allSettled(U).then(()=>{V.length==0?(l(1,t=`Updated ${A} words`),l(2,c="info")):(l(2,c="error"),l(1,t=`Failed to update ${V.length} words.  ${V}`)),Be(j),Ne(g)})}function w(g){function O(R,J){return R.dict_def=J.dict_def,!0}if(!r||!window.confirm("Lookup definitions for words without definitions?"))return;let j=ke(r),A=0,V=[],U=j.words.filter(R=>R.dict_def===void 0).map(async R=>{try{const J=await xe.default.lookup(R.word);J?(R.dict_def=J,A+=1):V.push(R.word)}finally{R.cache=et(R),tt(j,R,O)}});Promise.allSettled(U).then(()=>{V.length==0?(l(1,t=`Updated ${A} words`),l(2,c="info")):(l(2,c="error"),l(1,t=`Failed to update ${V.length} words.<br>${V}`)),Be(j),Ne(g)})}function _(){let g=ke(r);g.auto_defs=!0,Be(g),s("refreshlist",!0)}function E(){let g=ke(r);g.auto_defs=!1,Be(g),s("refreshlist",!0)}function N(g){t=g,l(1,t)}function D(g){t=g,l(1,t)}return n.$$set=g=>{"key"in g&&l(10,r=g.key),"autodefs"in g&&l(0,i=g.autodefs)},[i,t,c,a,d,v,p,w,_,E,r,N,D]}class Gt extends Pe{constructor(e){super(),$e(this,e,jt,Wt,Ae,{key:10,autodefs:0})}}function Jt(n){let e,l,s,r,i,t,c,a,d,v;return e=new yt({props:{current:"options"}}),c=new Pt({props:{backups:n[1],key:"words"}}),c.$on("refreshlist",n[2]),d=new Gt({props:{key:"words",autodefs:n[0].auto_defs}}),d.$on("refreshlist",n[2]),{c(){_e(e.$$.fragment),l=L(),s=m("h1"),r=z("Options"),i=L(),t=m("div"),_e(c.$$.fragment),a=L(),_e(d.$$.fragment),this.h()},l(p){pe(e.$$.fragment,p),l=P(p),s=b(p,"H1",{});var w=k(s);r=H(w,"Options"),w.forEach(u),i=P(p),t=b(p,"DIV",{class:!0});var _=k(t);pe(c.$$.fragment,_),a=P(_),pe(d.$$.fragment,_),_.forEach(u),this.h()},h(){o(t,"class","options-page")},m(p,w){me(e,p,w),q(p,l,w),q(p,s,w),f(s,r),q(p,i,w),q(p,t,w),me(c,t,null),f(t,a),me(d,t,null),v=!0},p(p,[w]){const _={};w&2&&(_.backups=p[1]),c.$set(_);const E={};w&1&&(E.autodefs=p[0].auto_defs),d.$set(E)},i(p){v||(Z(e.$$.fragment,p),Z(c.$$.fragment,p),Z(d.$$.fragment,p),v=!0)},o(p){se(e.$$.fragment,p),se(c.$$.fragment,p),se(d.$$.fragment,p),v=!1},d(p){be(e,p),p&&u(l),p&&u(s),p&&u(i),p&&u(t),be(c),be(d)}}}function Kt(n,e,l){let s=ke("words"),r=[];function i(){l(1,r=[]);for(let c=0;c<localStorage.length;c++){const a=localStorage.key(c);if(a)if(a!=="words"){let d=ke(a);r.push({name:a,key:c,size:d.words.length})}else r.unshift({name:a,key:c,size:s.words.length})}}i();function t(c){l(0,s=ke("words")),i()}return[s,r,t]}class xt extends Pe{constructor(e){super(),$e(this,e,Kt,Jt,Ae,{})}}export{xt as default};
